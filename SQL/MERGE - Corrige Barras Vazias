//O COMANDO ABAIXO FOI FEITO POR MIM, PARA CORRIGIR A TABELA DE ESTOQUE DO CLIENTE, QUE FICOU COM VÁRIAS BARRAS VAZIAS.
 // O CÓDIGO DE BARRAS É POR CÓDIGO, COR E TAMANHO, E AS VEZES UM CÓDIGO COR E TAMANHO QUE TINHA BARRA EM UM DEPOSITO, TINHA BARRA VAZIA EM OUTRO DEPOSITO
//ENTÃO ESSE COMANDO ACERTA OS CÓDIGOS DE BARRAS VAZIOS ONDE EXISTE CÓDIGO DE BARRA NÃO VAZIO NAQUELE MESMO CÓDIGO COR E TAMANHO

MERGE INTO PA_ITEN_001 PA_ERRADA
	USING (
	   SELECT
	   P.CODIGO,
       	   P.COR,
           P.TAM, 
           P.BARRA
   	   FROM PA_ITEN_001 P
       WHERE (P.BARRA <> '')) PA_CERTA
ON  PA_ERRADA.CODIGO = PA_CERTA.CODIGO
AND PA_ERRADA.COR = PA_CERTA.COR
AND PA_ERRADA.TAM = PA_CERTA.TAM
AND (PA_ERRADA.BARRA = '' OR PA_ERRADA.BARRA IS NULL)
WHEN MATCHED THEN 
UPDATE SET PA_ERRADA.BARRA = PA_CERTA.BARRA
