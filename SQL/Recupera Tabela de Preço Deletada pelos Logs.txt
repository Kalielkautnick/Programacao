INSERT INTO PRECO_COR_TAM_001 (REGIAO, CODIGO, COR, TAM, PRECO_OLD, DT_PROMOINI, DT_PROMOFIM, ORDEM_SEQ, ID_PCOR, REGRA, TIPO, LIBERADO_API, PRECO_PROMO, PRECO)
SELECT BKP.REGIAO, BKP.CODIGO, BKP.COR, BKP.TAM, BKP.PRECO_OLD, BKP.DT_PROMOINI, BKP.DT_PROMOFIM, BKP.ORDEM_SEQ, BKP.ID_PCOR,
BKP.REGRA, BKP.TIPO, BKP.LIBERADO_API, BKP.PRECO_PROMO, BKP.PRECO FROM PRECO_COR_TAM_BACKUP BKP
INNER JOIN
(SELECT DESCRICAO,
SUBSTRING (DESCRICAO FROM POS_CODIGO -1 FOR LEN_CODIGO) CODIGO,
SUBSTRING (DESCRICAO FROM POS_COR -1 FOR LEN_COR) COR,
SUBSTRING (DESCRICAO FROM POS_TAM -1 FOR LEN_TAM) TAM,
'006' AS TABELA
FROM (
SELECT DESCRICAO, NUMERO, POS_CODIGO, POS_COR, POS_TAM,
POSITION (',', SUBSTRING (DESCRICAO FROM POS_CODIGO FOR 100)) AS LEN_CODIGO,
POSITION (',', SUBSTRING (DESCRICAO FROM POS_COR FOR 100)) AS LEN_COR,
POSITION (',', SUBSTRING (DESCRICAO FROM POS_TAM FOR 100)) AS LEN_TAM
FROM (SELECT max (HORA) HORA, DESCRICAO, CHAVE AS NUMERO,
POSITION ('PRODUTO ', DESCRICAO)+9 POS_CODIGO,
POSITION ('COR ', DESCRICAO)+5 POS_COR,
POSITION ('TAM ', DESCRICAO)+5 POS_TAM
FROM LOG WHERE 1=1
AND UPPER(DESCRICAO) LIKE 'EXCLUS√ÉO DO PRODUTO%'
AND UPPER(DESCRICAO) LIKE '%TABELA 006'
AND UPPER(TELA) ='TFMVENTABPRECOCORTAM' 
AND UPPER(USUARIO) LIKE 'DIOGO%'
GROUP BY DESCRICAO, CHAVE
) LOG
) TAB) TAB2
 ON (BKP.CODIGO=TAB2.CODIGO) AND (BKP.COR=TAB2.COR) AND (BKP.TAM=TAB2.TAM) AND (BKP.REGIAO='006')
WHERE 1=1
AND NOT EXISTS (SELECT DISTINCT 1 FROM PRECO_COR_TAM_001 PR WHERE PR.CODIGO=TAB2.CODIGO AND PR.COR=TAB2.COR AND PR.TAM=TAB2.TAM AND PR.REGIAO = '006')