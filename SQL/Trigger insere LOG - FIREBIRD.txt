CREATE TRIGGER LANCA_LOG_RECEBER FOR RECEBER_001
ACTIVE AFTER UPDATE
POSITION 0
AS
BEGIN
     IF (:NEW.CONDICAO <> :OLD.CONDICAO) THEN
   BEGIN
   	INSERT INTO LOG (USUARIO, DATA, HORA, DESCRICAO, TELA, EMPRESA, OPERACAO, FORM)
   		VALUES
---CAPTURA O USUÁRIO ATUAL E COLOCA NO LOG 
   		((SELECT (SELECT MAX(L.USUARIO)
   		  FROM LOGUSR L
   		  WHERE L.CONNECTION = A.MON$ATTACHMENT_ID
     		  AND L.NUMERO = (SELECT MAX(L2.NUMERO)
                              FROM LOGUSR L2
                              WHERE L2.CONNECTION = A.MON$ATTACHMENT_ID)) AS USUARIO_ATUAL
             FROM MON$IO_STATS S
             INNER JOIN MON$ATTACHMENTS A ON A.MON$STAT_ID = S.MON$STAT_ID
             WHERE MON$STAT_GROUP = 1
             AND A.MON$ATTACHMENT_ID = CURRENT_CONNECTION), 
---FIM CAPTURA USUÁRIO, CONTINUA
CURRENT_DATE, CURRENT_TIME, 'CONDIÇÃO DE PAGAMENTO ALTERADA: ANTIGA-> ' || 
    OLD.CONDICAO || ' NOVA --> ' || NEW.CONDICAO, 'RECEBER', '001','TRIGGER','???');
   END  
END