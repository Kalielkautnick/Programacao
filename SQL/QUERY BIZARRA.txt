SELECT FIRST 1
	(SELECT TEXTO FROM MES_EXT(EXTRACT(MONTH FROM (DATEADD(1 MONTH TO CURRENT_DATE))))) AS MES1,
	(SELECT TEXTO FROM MES_EXT(EXTRACT(MONTH FROM (DATEADD(2 MONTH TO CURRENT_DATE))))) AS MES2,
	(SELECT TEXTO FROM MES_EXT(EXTRACT(MONTH FROM (DATEADD(3 MONTH TO CURRENT_DATE))))) AS MES3,
	(SELECT TEXTO FROM MES_EXT(EXTRACT(MONTH FROM (DATEADD(4 MONTH TO CURRENT_DATE))))) AS MES4,

/*TOTAL EM ABERTO CONTAS A PAGAR*/
(SELECT TEXTO FROM MONEY(
	(SELECT COALESCE(SUM((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV)),0)
   
FROM
	PAGTO_001 PAGTO
WHERE
        ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('DUPL'))
)))
AS CP_TOTAL_EM_ABERTO,

/*TOTAL EM ABERTO CONTAS A PAGAR ORÇAMENTOS*/
(SELECT TEXTO FROM MONEY(
	(SELECT COALESCE(SUM((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV)),0)
   
FROM
	PAGTO_001 PAGTO
WHERE
        ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('ORCA'))
)))
AS ORCA_TOTAL_EM_ABERTO,

/*CONTAS A PAGAR EMITIDOS NO DIA ANTERIOR*/
(SELECT TEXTO FROM MONEY((SELECT SUM(PG.VALOR) FROM PAGTO_001 PG
WHERE
PG.DT_ATUAL = CURRENT_DATE  - 1 AND
PG.STATUS IN ('ORCA','DUPL')))) 
AS CP_EMITIDOS_DIA_ANTERIOR,

/*CONTAS A PAGAR: A PAGAR NA SEMANA PL*/
(SELECT TEXTO FROM MONEY(
	(SELECT COALESCE(SUM(((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))),0)
FROM
	PAGTO_001 PAGTO
WHERE
	PAGTO.DT_VEN <= CURRENT_DATE + (5 - EXTRACT(WEEKDAY FROM CURRENT_DATE))
	AND PAGTO.DT_VEN >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)+1)
	AND ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('DUPL','ORCA'))
)   )) 
AS CP_A_PAGAR_SEMANA_PL,


/*CONTAS A PAGAR: A PAGAR NO MES PL*/
(SELECT TEXTO FROM MONEY(
	(SELECT COALESCE(SUM((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV)),0)
   
FROM
	PAGTO_001 PAGTO
WHERE
	PAGTO.DT_VEN <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY 
FROM CURRENT_DATE) + 32))
	AND PAGTO.DT_VEN >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) 
	AND ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('DUPL','ORCA'))
))) 
AS CP_A_PAGAR_NO_MES_PL,

/*CONTAS A PAGAR: A PAGAR NO PRÓXIMO DO MES PL*/
(SELECT TEXTO FROM MONEY(
	(SELECT COALESCE(SUM((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV)),0)
FROM
	PAGTO_001 PAGTO
WHERE
	PAGTO.DT_VEN <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY 
FROM CURRENT_DATE) + 64))
	AND PAGTO.DT_VEN >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY 
FROM CURRENT_DATE) + 32)) + 1 
	AND ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('DUPL','ORCA'))
)))
AS CP_A_PAGAR_NO_MES1_PL,

/*CONTAS A PAGAR: A PAGAR DOIS MESES A FRENTE PL*/
(SELECT TEXTO FROM MONEY(
	(SELECT COALESCE(SUM((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV)),0)
FROM
	PAGTO_001 PAGTO
WHERE
	PAGTO.DT_VEN <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY 
FROM CURRENT_DATE) + 94))
	AND PAGTO.DT_VEN >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY 
FROM CURRENT_DATE) + 64)) + 1 
	AND ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('DUPL','ORCA'))
))) 
AS CP_A_PAGAR_NO_MES2_PL,


/*CONTAS A PAGAR: A PAGAR 3 MESES A FRENTE PL*/
(SELECT TEXTO FROM MONEY(
	(SELECT COALESCE(SUM((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV)),0)
FROM
	PAGTO_001 PAGTO
WHERE
	PAGTO.DT_VEN <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 124 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY 
FROM CURRENT_DATE) + 124))
	AND PAGTO.DT_VEN >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY 
FROM CURRENT_DATE) + 94)) + 1 
	AND ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('DUPL','ORCA'))
)))
AS CP_A_PAGAR_NO_MES3_PL,

/*CONTAS A PAGAR: ATRASADOS PL*/
(SELECT
    (SELECT TEXTO FROM MONEY(SUM(((PAGTO.VALOR + PAGTO.JUROS) - (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV)))))
FROM
	PAGTO_001 PAGTO
WHERE
	PAGTO.DT_VEN < CURRENT_DATE
	AND ((PAGTO.VALOR + PAGTO.JUROS) > (PAGTO.VAL_PAG + PAGTO.DESCONTO + PAGTO.VAL_DEV))  
	AND (PAGTO.STATUS IN('DUPL','ORCA')) 
) 
AS CP_VENCIDO_ATRASADO_PL,

(SELECT TEXTO FROM MONEY((SELECT SUM(( RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO 
         - 
         RECEBER.VAL_DEV )) AS SALDO 
FROM   RECEBER_001 RECEBER 
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' ) 
       AND RECEBER.SITUACAO IN ('01','31','47','48','41'))))
AS SALDO_CONTAS,
      
(SELECT TEXTO FROM MONEY((SELECT  SUM(RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO - RECEBER.VAL_DEV)
FROM      RECEBER_001 RECEBER
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' )
       AND (RECEBER.DT_VENCTO < CURRENT_DATE) 
       AND RECEBER.SITUACAO IN ('31','48','41'))))  
AS A_RECEBER_EM_ATRASO,

(SELECT TEXTO FROM MONEY((SELECT SUM(( RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO 
         - 
         RECEBER.VAL_DEV )) AS SALDO 
FROM   RECEBER_001 RECEBER 
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' ) 
       AND RECEBER.SITUACAO = '31')))
AS A_RECEBER_CARTEIRA_31,

(SELECT TEXTO FROM MONEY((SELECT SUM(( RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO 
         - 
         RECEBER.VAL_DEV )) AS SALDO 
FROM   RECEBER_001 RECEBER 
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' ) 
       AND RECEBER.SITUACAO = '01')))
AS A_RECEBER_CARTEIRA_01,

(SELECT TEXTO FROM MONEY((SELECT SUM(( RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO 
         - 
         RECEBER.VAL_DEV )) AS SALDO 
FROM   RECEBER_001 RECEBER 
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' ) 
       AND RECEBER.SITUACAO = '47'))) 
AS A_RECEBER_CARTEIRA_47,

(SELECT TEXTO FROM MONEY((SELECT SUM(( RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO 
         - 
         RECEBER.VAL_DEV )) AS SALDO 
FROM   RECEBER_001 RECEBER 
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' ) 
       AND RECEBER.SITUACAO = '33')))
AS A_RECEBER_CARTEIRA_33,

(SELECT TEXTO FROM MONEY((SELECT SUM(( RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO 
         - 
         RECEBER.VAL_DEV )) AS SALDO 
FROM   RECEBER_001 RECEBER 
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' ) 
       AND RECEBER.SITUACAO = '48')))
AS A_RECEBER_CARTEIRA_48,

(SELECT TEXTO FROM MONEY((SELECT SUM(( RECEBER.VALOR2 + RECEBER.JUROS - RECEBER.VALOR_PAGO - RECEBER.DESCONTO 
         - 
         RECEBER.VAL_DEV )) AS SALDO 
FROM   RECEBER_001 RECEBER 
WHERE  (RECEBER.STATUS IN ('DUPL','ORCA'))
       AND ( ( RECEBER.VALOR2 + RECEBER.JUROS ) > ( 
             RECEBER.VALOR_PAGO + RECEBER.DESCONTO 
             + RECEBER.VAL_DEV ) ) 
       AND ( RECEBER.SITUACAO <> 'P' ) 
       AND RECEBER.SITUACAO = '41')))
AS A_RECEBER_CARTEIRA_41,
       
(SELECT
	(SELECT TEXTO FROM MONEY(ROUND( SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) ), 2)))
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE + (7 - EXTRACT(WEEKDAY FROM CURRENT_DATE)) AND
    ENTI.SIT_CLI = '1') 
AS A_FATURAR_SEMANA_VLR,

CAST((SELECT
	SUM(PDI.QTDE)

FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE + (7 - EXTRACT(WEEKDAY FROM CURRENT_DATE)) AND
    ENTI.SIT_CLI = '1')AS INTEGER) 
AS A_FATURAR_SEMANA_QTD,

(SELECT TEXTO FROM MONEY((SELECT
	SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) )
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE + (7 - EXTRACT(WEEKDAY FROM CURRENT_DATE)) AND
    ENTI.SIT_CLI = '1'
) /
(
CASE WHEN (SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE + (7 - EXTRACT(WEEKDAY FROM CURRENT_DATE)) AND
    ENTI.SIT_CLI = '1') = 0 THEN 1 ELSE
    (SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE + (7 - EXTRACT(WEEKDAY FROM CURRENT_DATE)) AND
    ENTI.SIT_CLI = '1') END
    
    ))) 
AS TICKET_MEDIO_SEMANA,

(SELECT
	(SELECT TEXTO FROM MONEY(ROUND( SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) ), 2)))
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) AND
    ENTI.SIT_CLI = '1'
) AS 
A_FATURAR_MES_VLR,

CAST((SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) AND
    ENTI.SIT_CLI = '1'
)AS INTEGER) 
AS A_FATURAR_MES_QTD,

(SELECT TEXTO FROM MONEY((SELECT
	SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) )
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) AND
    ENTI.SIT_CLI = '1'
) /

(SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) AND
    ENTI.SIT_CLI = '1'
))) 
AS TICKET_MEDIO_MES_ATUAL,

(SELECT
	(SELECT TEXTO FROM MONEY(ROUND( SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) ), 2)))
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) AND
    ENTI.SIT_CLI = '1' ) 
AS A_FATURAR_MES1_VLR,
    
CAST((SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) AND
    ENTI.SIT_CLI = '1' )AS INTEGER) 
AS A_FATURAR_MES1_QTD,
    
(SELECT TEXTO FROM MONEY((SELECT
	SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) )
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) AND
    ENTI.SIT_CLI = '1' )/
(SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 32)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) AND
    ENTI.SIT_CLI = '1' )))
AS TICKET_MEDIO_MES1,
    
(SELECT
	(SELECT TEXTO FROM MONEY(ROUND( SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) ), 2)))
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) AND
    ENTI.SIT_CLI = '1') 
AS A_FATURAR_MES2_VLR,
    
CAST((SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) AND
    ENTI.SIT_CLI = '1')AS INTEGER)
AS A_FATURAR_MES2_QTD,
    
(SELECT TEXTO FROM MONEY((SELECT
	SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) )
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) AND
    ENTI.SIT_CLI = '1')/
(SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 64)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) AND
    ENTI.SIT_CLI = '1')))
AS TICKET_MEDIO_MES2,
    
(SELECT
	(SELECT TEXTO FROM MONEY(ROUND( SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) ), 2)))
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 124 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 124)) AND
    ENTI.SIT_CLI = '1') 
AS A_FATURAR_MES3_VLR,
    
CAST((SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 124 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 124)) AND
    ENTI.SIT_CLI = '1')AS INTEGER)
AS A_FATURAR_MES3_QTD,
    
(SELECT TEXTO FROM MONEY((SELECT
	SUM( (PDI.QTDE) * (UDF_NVL(PDI.PRECO) - (UDF_NVL(PDI.PRECO)*UDF_NVL(PDD.PER_DESC)/100)) )
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 124 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 124)) AND
    ENTI.SIT_CLI = '1') /
(SELECT
	SUM(PDI.QTDE)
FROM
	PEDIDO_001 PDD
    LEFT JOIN PED_ITEN_001 PDI ON PDD.NUMERO = PDI.NUMERO
    LEFT JOIN ENTIDADE_001 ENTI ON PDD.CODCLI = ENTI.CODCLI
WHERE
	PDD.TIPO = 'P' AND
    PDD.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 94)) + 1 AND
    PDD.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 124 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM 
CURRENT_DATE) + 124)) AND
    ENTI.SIT_CLI = '1')))
AS TICKET_MEDIO_MES3,
    
    (SELECT 
CAST(SUM(A.QUANT) AS INTEGER)
FROM FACCAO3_001 A
LEFT JOIN PEDIDO_001 PED ON PED.NUMERO = A.PEDIDO
LEFT JOIN ENTIDADE_001 ENT ON ENT.CODCLI = PED.CODCLI
LEFT JOIN TIPO_APL_001 B ON B.CODIGO = A.PARTE
WHERE B.ESTOQUE = 'S' 
    AND	A.PEDIDO = PED.NUMERO AND
	A.OP = '02' AND
    ENT.SIT_CLI = '1'
    AND PED.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)-1) 
    AND PED.DT_FATURA <= CURRENT_DATE + (7 - EXTRACT(WEEKDAY FROM CURRENT_DATE)))
AS TALHADO_SEMANA,
    
(SELECT 
CAST(SUM(A.QUANT) AS INTEGER)
FROM FACCAO3_001 A
LEFT JOIN PEDIDO_001 PED ON PED.NUMERO = A.PEDIDO
LEFT JOIN ENTIDADE_001 ENT ON ENT.CODCLI = PED.CODCLI
LEFT JOIN TIPO_APL_001 B ON B.CODIGO = A.PARTE
WHERE B.ESTOQUE = 'S' 
    AND	A.PEDIDO = PED.NUMERO AND
	A.OP = '02' AND
    ENT.SIT_CLI = '1'
    AND PED.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32))
    AND PED.DT_FATURA >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1))
AS TALHADO_MES,
    
(SELECT 
CAST(SUM(A.QUANT) AS INTEGER)
FROM FACCAO3_001 A
LEFT JOIN PEDIDO_001 PED ON PED.NUMERO = A.PEDIDO
LEFT JOIN ENTIDADE_001 ENT ON ENT.CODCLI = PED.CODCLI
LEFT JOIN TIPO_APL_001 B ON B.CODIGO = A.PARTE
WHERE B.ESTOQUE = 'S' 
    AND	A.PEDIDO = PED.NUMERO AND
	A.OP = '02' AND
    ENT.SIT_CLI = '1'
    AND PED.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64)) 
    AND PED.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32)) + 1)
AS TALHADO_MES1,
    
(SELECT 
CAST(SUM(A.QUANT) AS INTEGER)
FROM FACCAO3_001 A
LEFT JOIN PEDIDO_001 PED ON PED.NUMERO = A.PEDIDO
LEFT JOIN ENTIDADE_001 ENT ON ENT.CODCLI = PED.CODCLI
LEFT JOIN TIPO_APL_001 B ON B.CODIGO = A.PARTE
WHERE B.ESTOQUE = 'S' 
    AND	A.PEDIDO = PED.NUMERO AND
	A.OP = '02' AND
    ENT.SIT_CLI = '1'
    AND PED.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94)) 
    AND PED.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 64)) + 1)
AS TALHADO_MES2,
    
(SELECT 
CAST(SUM(A.QUANT) AS INTEGER)
FROM FACCAO3_001 A
LEFT JOIN PEDIDO_001 PED ON PED.NUMERO = A.PEDIDO
LEFT JOIN ENTIDADE_001 ENT ON ENT.CODCLI = PED.CODCLI
LEFT JOIN TIPO_APL_001 B ON B.CODIGO = A.PARTE
WHERE B.ESTOQUE = 'S' 
    AND	A.PEDIDO = PED.NUMERO AND
	A.OP = '02' AND
    ENT.SIT_CLI = '1'
    AND PED.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 124 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 124)) 
    AND PED.DT_FATURA >= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 94)) + 1 )
AS TALHADO_MES3,
    
(SELECT 
CAST(SUM(A.QUANT) AS INTEGER)
FROM FACCAO3_001 A
LEFT JOIN TIPO_APL_001 B ON B.CODIGO = A.PARTE
WHERE B.ESTOQUE = 'S' 
  AND  A.OP = '02'  	
  AND  A.DT_LAN >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)-1) 
  AND  A.DT_LAN  <= CURRENT_DATE + (7 - EXTRACT(WEEKDAY FROM CURRENT_DATE)))
AS TALHADO_PROD_SEMANA,
    
(SELECT 
CAST(SUM(A.QUANT) AS INTEGER)
FROM FACCAO3_001 A
LEFT JOIN TIPO_APL_001 B ON B.CODIGO = A.PARTE
WHERE B.ESTOQUE = 'S'  
    AND  A.OP = '02'  
    AND A.DT_LAN <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32))
    AND A.DT_LAN >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1))
AS TALHADO_PROD_MES,
    

 (SELECT TEXTO FROM MONEY((SELECT SUM(PED_ITEN.QTDE_F*UDF_NVL(PED_ITEN.PRECO))
FROM   PEDIDO_001 PEDIDO
       INNER JOIN PED_ITEN_001 PED_ITEN
               ON ( PEDIDO.NUMERO = PED_ITEN.NUMERO )
       LEFT JOIN ENTIDADE_001 CLIENTE
              ON ( PEDIDO.CODCLI = CLIENTE.CODCLI )
WHERE  PEDIDO.DT_FATURA <= CURRENT_DATE + (5 - EXTRACT(WEEKDAY FROM CURRENT_DATE))
       AND PEDIDO.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)+1)
       AND CLIENTE.SIT_CLI = '1')))
AS FAT_NA_SEMANA_VLR,

(SELECT CAST(SUM(PED_ITEN.QTDE_F) AS INTEGER)
FROM   PEDIDO_001 PEDIDO
       INNER JOIN PED_ITEN_001 PED_ITEN
               ON ( PEDIDO.NUMERO = PED_ITEN.NUMERO )
       LEFT JOIN ENTIDADE_001 CLIENTE
              ON ( PEDIDO.CODCLI = CLIENTE.CODCLI )
WHERE PEDIDO.DT_FATURA <= CURRENT_DATE + (5 - EXTRACT(WEEKDAY FROM CURRENT_DATE))
       AND PEDIDO.DT_FATURA >= CURRENT_DATE - (EXTRACT(WEEKDAY FROM CURRENT_DATE)+1)
       AND CLIENTE.SIT_CLI = '1')
AS FAT_NA_SEMANA_QTDE,
       
(SELECT TEXTO FROM MONEY((SELECT SUM(PED_ITEN.QTDE_F*UDF_NVL(PED_ITEN.PRECO))
FROM   PEDIDO_001 PEDIDO
       INNER JOIN PED_ITEN_001 PED_ITEN
               ON ( PEDIDO.NUMERO = PED_ITEN.NUMERO )
       LEFT JOIN ENTIDADE_001 CLIENTE
              ON ( PEDIDO.CODCLI = CLIENTE.CODCLI )
WHERE  PEDIDO.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32))
       AND PEDIDO.DT_FATURA >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1)
       AND CLIENTE.SIT_CLI = '1')))
AS FAT_NO_MES_VLR,
       
(SELECT CAST(SUM(PED_ITEN.QTDE_F) AS INTEGER)
FROM   PEDIDO_001 PEDIDO
       INNER JOIN PED_ITEN_001 PED_ITEN
               ON ( PEDIDO.NUMERO = PED_ITEN.NUMERO )
       LEFT JOIN ENTIDADE_001 CLIENTE
              ON ( PEDIDO.CODCLI = CLIENTE.CODCLI )
WHERE  PEDIDO.DT_FATURA <= CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32 - EXTRACT(DAY FROM (CURRENT_DATE - EXTRACT(DAY FROM CURRENT_DATE) + 32))
       AND PEDIDO.DT_FATURA >= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1)
       AND CLIENTE.SIT_CLI = '1')
AS FAT_NO_MES_QTDE,
       
(SELECT TEXTO FROM MONEY((SELECT SUM(PED_ITEN.QTDE_F*UDF_NVL(PED_ITEN.PRECO))
FROM   PEDIDO_001 PEDIDO
       INNER JOIN PED_ITEN_001 PED_ITEN
               ON ( PEDIDO.NUMERO = PED_ITEN.NUMERO )
       LEFT JOIN ENTIDADE_001 CLIENTE
              ON ( PEDIDO.CODCLI = CLIENTE.CODCLI )
WHERE  PEDIDO.DT_FATURA >= (CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) - 1) - (EXTRACT(DAY FROM (CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) - 1))-1)
       AND PEDIDO.DT_FATURA <= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) - 1
       AND CLIENTE.SIT_CLI = '1')))
AS FAT_NO_MES_ANT_VLR,
       
(SELECT CAST(SUM(PED_ITEN.QTDE_F) AS INTEGER)
FROM   PEDIDO_001 PEDIDO
       INNER JOIN PED_ITEN_001 PED_ITEN
               ON ( PEDIDO.NUMERO = PED_ITEN.NUMERO )
       LEFT JOIN ENTIDADE_001 CLIENTE
              ON ( PEDIDO.CODCLI = CLIENTE.CODCLI )
WHERE  PEDIDO.DT_FATURA >= (CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) - 1) - (EXTRACT(DAY FROM (CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) - 1))-1)
       AND PEDIDO.DT_FATURA <= CURRENT_DATE - (EXTRACT(DAY FROM CURRENT_DATE)-1) - 1
       AND CLIENTE.SIT_CLI = '1')
AS FAT_NO_MES_ANT_QTDE

FROM EMPRESA